<h1>{{ title }}</h1>
<form *ngIf="!loading" [formGroup]="form" (ngSubmit)="onSubmit()">
  <div class="form-container">
    <mat-form-field appearance="fill" class="form-field">
      <mat-label>Title</mat-label>
      <mat-select formControlName="title">
        <mat-option value=""></mat-option>
        <mat-option value="Mr">Mr</mat-option>
        <mat-option value="Mrs">Mrs</mat-option>
        <mat-option value="Miss">Miss</mat-option>
        <mat-option value="Ms">Ms</mat-option>
      </mat-select>
      <mat-error *ngIf="submitted && f.title.errors?.required">Title is required</mat-error>
    </mat-form-field>

    <mat-form-field appearance="fill" class="form-field">
      <mat-label>First Name</mat-label>
      <input matInput type="text" formControlName="firstName" />
      <mat-error *ngIf="submitted && f.firstName.errors?.required">First Name is required</mat-error>
    </mat-form-field>

    <mat-form-field appearance="fill" class="form-field">
      <mat-label>Last Name</mat-label>
      <input matInput type="text" formControlName="lastName" />
      <mat-error *ngIf="submitted && f.lastName.errors?.required">Last Name is required</mat-error>
    </mat-form-field>

    <mat-form-field appearance="fill" class="form-field">
      <mat-label>Email</mat-label>
      <input matInput type="email" formControlName="email" />
      <mat-error *ngIf="submitted && f.email.errors?.required">Email is required</mat-error>
      <mat-error *ngIf="submitted && f.email.errors?.email">Invalid email address</mat-error>
    </mat-form-field>

    <mat-form-field appearance="fill" class="form-field">
      <mat-label>Role</mat-label>
      <mat-select formControlName="role">
        <mat-option value=""></mat-option>
        <mat-option value="User">User</mat-option>
        <mat-option value="Admin">Admin</mat-option>
      </mat-select>
      <mat-error *ngIf="submitted && f.role.errors?.required">Role is required</mat-error>
    </mat-form-field>

    <div *ngIf="id">
      <h3>Change Password</h3>
      <p>Leave blank to keep the same password</p>
    </div>

    <mat-form-field appearance="fill" class="form-field">
      <mat-label>Password</mat-label>
      <input matInput type="password" formControlName="password" />
      <mat-error *ngIf="submitted && f.password.errors?.required">Password is required</mat-error>
      <mat-error *ngIf="submitted && f.password.errors?.minlength">Password must be at least 6 characters</mat-error>
    </mat-form-field>

    <mat-form-field appearance="fill" class="form-field">
      <mat-label>Confirm Password</mat-label>
      <input matInput type="password" formControlName="confirmPassword" />
      <mat-error *ngIf="submitted && f.confirmPassword.errors?.required">Confirm Password is required</mat-error>
      <mat-error *ngIf="submitted && f.confirmPassword.errors?.mustMatch">Passwords must match</mat-error>
    </mat-form-field>
  </div>

  <div class="form-group">
    <button mat-raised-button color="primary" [disabled]="loading">Save</button>
    <a mat-button routerLink="/users">Cancel</a>
  </div>
</form>

<div *ngIf="loading" class="text-center m-5">
  <mat-spinner></mat-spinner>
</div>
